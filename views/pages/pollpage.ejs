<!DOCTYPE html>
<html>
    <head>
        <% include ../partials/head %>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300" rel="stylesheet">
    </head>
    <body>
        <% include ../partials/header %>
        <div class='pollpage-container'>
            <div class='votes-box'>
                <form action='/see_poll' method='POST' class='submit-votes'>
                    <select name='selected' class="submit-options" required>
                        <option value='' disabled selected>Choose an option</option>
                        <% for (var i = 0; i < poll.allvotes.length; i++) { %>
                            <option value='<%= '{"id": "' + poll.id + '", "index": ' + i + ', "option": "' + poll.allvotes[i].option + '"}' %>'>
                                <%= poll.allvotes[i].option %>
                            </option>
                        <% } %>
                    </select>
                    <button type='submit' class="major-btn submit-vote-btn" title='VOTE!'>VOTE!</button>
                </form>
                <% if (locals.user) { %>
                    <button type="button" class='minor-btn custom-option-toggle-btn' title='Add an option'>Or add your own</button>
                    <form action='/custom_option' method='POST' class="custom-option-form">
                        <input type='hidden' name='id' value='<%= poll.id %>'>
                        <input type='text' name='newoption' class='custom-option' placeholder='Your option'>
                        <button type='submit' class='minor-btn' title='Add option'>add</button>
                    </form>
                <% } else { %>
                    <button type="button" class='minor-btn custom-option-toggle-btn disabled-btn' title='You must be signed in to add an option'>
                        Or add your own<i class="fa fa-ban"></i>
                    </button>
                <% } %>
            </div>
            
            <div class='graph-container'>
                <div class='graph-center'></div>
            </div>
        </div>
        <% include ../partials/footer %>
        <script type='text/javascript'>
            var seedTitle = '<%= poll.title %>';
            var seedData = JSON.parse('<%- JSON.stringify(poll.allvotes)%>');
        </script>
        <script src='/views/scripts/d3.min.js' rel="script" type="text/javascript"></script>
        <script src="/views/scripts/pollpage.js" rel="script" type="text/javascript"></script>
    </body>
</html>